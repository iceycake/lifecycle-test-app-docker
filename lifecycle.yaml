---
version: '0.0.3-alpha-1'

environment:
  webhooks:
    - state: 'deployed'
      type: 'codefresh'
      name: 'Lifecycle: Deployed'
      description: 'GraphQL Contentful/Lifecycle: Deployed'
      pipelineId: '63a5f73e6d7b760e3da8163b'
      trigger: 'Verify'
      env:
        branch: 'main'    
        ENV: 'lifecycle'
        ENV: 'should error'
  defaultServices:
    - name: 'lifecycle-test-app-docker'

services:
  - name: 'lifecycle-test-app-docker'
    github:
      repository: 'iceycake/lifecycle-test-app-docker'
      branchName: 'main'
      docker:
        defaultTag: 'main'
        app:
          dockerfilePath: 'sysops/dockerfiles/app.dockerfile'
          ports:
            - 80
          env:
            ENV: lifecycle
            COMPONENT: app
            DB_HOST: "{{lta-db_internalHostname}}"
            BUILD_UUID: "{{buildUUID}}"        
      deployment:
        public: true
        capacityType: 'SPOT'
        network:
          grpc:
            enable: true
